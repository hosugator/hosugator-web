---
created: 2025-12-22 Mon
tags: [aws, sqs, error_handling, reliability]
reference:
  - "[[Amazon SQS]]"
---

# Amazon SQS Dead-letter queue (DLQ)

## 정의 (Definition)
메시지 처리를 여러 번 시도했으나 성공하지 못한 '결함 있는 메시지'를 따로 격리하여 보관하는 보조 대기열

## 핵심 맥락 (Context & Why)
### Problem
특정 메시지의 형식이 잘못되었거나 처리 로직에 버그가 있는 경우, 해당 메시지가 계속해서 재처리를 시도하며 전체 대기열의 처리를 지연시키고 시스템 리소스를 낭비(Poison Pill 문제)하게 됩니다.
### Solution
설정한 재시도 횟수(maxReceiveCount)를 초과한 메시지를 DLQ로 자동 이동시켜, 정상적인 메시지들의 흐름을 방해하지 않으면서 실패한 원인을 나중에 별도로 분석할 수 있게 합니다.

## 작동 원리 (Mechanism) 
### 재시도 횟수 초과
메시지 수신 횟수가 미리 설정한 임계값에 도달하면 SQS가 해당 메시지를 원본 대기열에서 제거하고 DLQ로 보냅니다.
### 메시지 격리
DLQ에 쌓인 메시지는 자동으로 삭제되지 않으며(설정한 보관 기간까지), 관리자가 수동으로 확인하거나 별도의 로직으로 처리할 수 있습니다.
### 가시성 타임아웃과의 연계
메시지가 처리되는 동안 다른 소비자가 볼 수 없는 '가시성 타임아웃'이 끝날 때까지 처리가 완료되지 않으면 다시 대기열에 나타나는데, 이 횟수가 누적되면 DLQ로 이동합니다.

## 유비 및 비교 (Analogy & Comparison)
### It's like
우체국에서 주소가 불분명하여 배달할 수 없는 편지들을 따로 모아두는 '반송 우편물 보관함'과 같습니다. 집배원이 같은 편지를 들고 계속 헛걸음하는 것을 방지합니다.
### vs (유사 개념)
- Standard Queue: 모든 메시지가 처리되기를 기다리는 일반적인 통로입니다.
- Dead-letter Queue: 처리 시스템을 망가뜨릴 수 있는 '나쁜 메시지'만 모아둔 격리 수용소입니다.

---
See Also:
- [[SQS Visibility Timeout]]
- [[Redrive Policy in SQS]]