---
created: 2025-11-14
tags:
  - aws
  - athena
  - serverless
  - analytics
  - s3
  - sql
  - presto
reference:
---
# Amazon Athena
## 정의
표준 SQL을 사용하여 [[S3]]에 있는 데이터를 직접 분석할 수 있는 서버리스 대화형 쿼리 서비스
## 원리
### 쿼리 온 데이터(Query-on-Data)
- 별도의 데이터 웨어하우스나 클러스터를 프로비저닝하거나 관리할 필요 없이, [[S3]]에 저장된 데이터를 대상으로 직접 쿼리를 실행한다.
- 데이터베이스 엔진으로 오픈 소스 분산 쿼리 엔진인 Presto를 사용하며, 표준 SQL을 지원한다.
### 비용 모델
- 실행된 쿼리가 스캔한 데이터 양에 대해서만 요금이 부과된다.
- 데이터를 압축하거나 파티션을 나누어 스캔량을 줄이면 비용을 절감할 수 있다.
## 요소
- 데이터 카탈로그(Data Catalog): 데이터베이스 및 테이블 스키마 정보가 저장되는 메타데이터 리포지토리이다. [[Glue]]와 통합되어 사용된다.
- S3 데이터 레이크: 쿼리의 대상이 되는 원본 데이터가 저장된 [[S3]] 버킷이다. CSV, JSON, Parquet 등 다양한 파일 형식을 지원한다.
- 파티션(Partition): 데이터 스캔 범위를 줄이기 위해 데이터 파일을 날짜나 지역과 같은 특정 열(Column) 값별로 구조화하는 방식이다.
## 특징
- 서버리스: 인프라 관리나 용량 확장에 대한 걱정 없이 즉시 쿼리를 실행할 수 있다.
- 유연성: [[S3]]에 저장된 다양한 형식의 비정형, 반정형, 정형 데이터를 쿼리할 수 있다.
- 보안: [[S3]] 버킷 정책과 [[IAM]]을 사용하여 데이터 접근을 제어한다.
- 사용 사례: [[CloudTrail]] 로그 분석, [[S3]] 데이터 레이크 탐색, 임시 분석 등 다양한 데이터 탐색 작업에 사용된다.
## 비교
| 구분 | Athena | [[Redshift]] |
| :--- | :--- | :--- |
| 인프라 | 서버리스 (클러스터 관리 불필요) | 클러스터 기반 (노드 및 확장 관리 필요) |
| 비용 모델 | 쿼리 스캔량 기반 요금 (사용량 기반) | 인스턴스 시간 기반 요금 (클러스터 유지 비용) |
| 주 사용처 | 임시 분석, [[S3]] 데이터 레이크 탐색 | 반복적이고 복잡한 BI 보고서, 대규모 데이터 웨어하우징 |
## 예시
- CloudTrail 로그 분석:
    1. [[CloudTrail]]이 모든 API 활동 로그를 [[S3]] 버킷에 저장한다.
    2. 데이터 분석가가 Athena를 사용하여 해당 [[S3]] 버킷의 로그 데이터를 대상으로 "지난 7일간 특정 [[IAM]] 사용자가 수행한 모든 `DeleteObject` API 호출을 찾아라"와 같은 표준 SQL 쿼리를 실행한다.
    3. Athena는 로그 파일을 직접 스캔하여 결과를 반환하며, 클러스터를 설정할 필요 없이 즉시 분석 결과를 얻을 수 있다.