---
created: 2025-11-13
tags: [aws_saa, cloudformation, template, stack, drift, parameter]
reference:
  - https://docs.aws.amazon.com/cloudformation/latest/userguide/what-is-cloudformation.html
---
# AWS CloudFormation
## 정의
AWS 리소스 컬렉션을 코드로 모델링하고 프로비저닝하여 인프라를 자동화하는 서비스 (Infrastructure as Code, IaC)
## 원리
### IaC (Infrastructure as Code)
- 원하는 AWS 인프라(리소스)를 YAML 또는 JSON 형식의 템플릿 파일로 정의한다.
- 템플릿을 사용하여 스택(Stack)을 생성하면, CloudFormation이 템플릿에 정의된 순서와 의존성에 따라 자동으로 리소스를 생성하고 구성한다.
- 인프라 변경(업데이트)이 필요할 경우, 템플릿을 수정하고 스택 업데이트를 실행하여 변경 사항을 안전하게 적용한다.
### 드리프트(Drift) 감지
- CloudFormation 외부(예: AWS 콘솔에서 수동 작업)에서 스택 리소스가 변경될 경우, 템플릿 정의와 실제 리소스 상태 간의 차이를 드리프트(Drift)라고 한다.
- CloudFormation은 드리프트를 감지하여 리소스의 현재 상태가 템플릿과 일치하는지 확인할 수 있다.
## 요소
- 템플릿(Template): 스택을 구성할 리소스를 정의하는 YAML 또는 JSON 파일이다. Resources 섹션이 필수적이다.
- 스택(Stack): 템플릿에 정의된 리소스의 컬렉션이며, 단일 단위로 관리된다.
- 변경 세트(Change Set): 스택에 실제로 변경 사항을 적용하기 전에, 새로운 템플릿이 기존 스택에 어떤 영향을 미칠지 미리 보여주는 미리보기 기능이다.
- 스택 세트(Stack Set): 단일 템플릿을 사용하여 여러 AWS 계정 또는 여러 리전에 걸쳐 스택을 배포하고 관리할 수 있는 기능이다.
## 특징
- 자동화 및 반복 가능성: 인프라 배포 과정을 자동화하여, 일관되고 반복 가능한 환경 구축을 보장한다.
- 의존성 관리: 리소스 간의 생성 순서나 의존성을 자동으로 파악하여 적절한 순서로 리소스를 생성한다.
- 롤백(Rollback): 스택 생성이나 업데이트가 실패할 경우, 자동으로 모든 리소스를 이전 상태로 되돌려 안정성을 확보한다.
- 비용 관리: 생성된 모든 리소스가 스택에 묶여 있기 때문에, 스택 삭제만으로 모든 리소스를 쉽게 정리할 수 있어 비용 누수를 방지한다.
## 비교
| 구분 | CloudFormation | [[Terraform]] (오픈소스) |
| :--- | :--- | :--- |
| 적용 범위 | AWS 리소스에 한정 | AWS, Azure, GCP 등 멀티 클라우드 및 SaaS |
| 상태 관리 | AWS 내부에서 관리 (S3에 저장) | 로컬 파일 또는 원격 백엔드에서 관리 |
| 특징 | AWS 서비스와의 깊은 통합, 쉬운 롤백 | 멀티 클라우드 환경에서 이식성 및 유연성 높음 |
## 예시
- 웹 서비스 환경 구축:
    1. 개발팀이 [[VPC]], [[EC2]] 인스턴스, [[RDS]] 데이터베이스, 로드 밸런서 등 전체 웹 서비스 아키텍처를 하나의 CloudFormation 템플릿으로 정의한다.
    2. 운영팀은 이 템플릿을 사용하여 개발, 스테이징, 프로덕션 환경에 대해 각각 스택을 생성한다.
    3. 이렇게 생성된 환경들은 모두 동일한 구성과 설정을 가지며, 단일 스택 관리만으로 전체 환경의 변경 및 삭제가 가능하다.