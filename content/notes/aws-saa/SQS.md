---
created: 2025-11-14
tags: [aws_saa, sqs, queue, message, polling, dlq, serverless]
reference:
  - https://docs.aws.amazon.com/sqs/latest/sqs/what-is-sqs.html
---
# Amazon SQS (Simple Queue Service)
## 정의
분산된 시스템 구성 요소 간에 메시지를 주고받을 수 있도록 지원하는 완전 관리형 메시지 대기열(Message Queue) 서비스
## 요소
### Producer (생산자)
메시지를 생성하여 SQS 대기열(Queue)에 보내는 컴포넌트이다. (예: 웹 서버, Lambda 함수)
### Consumer (소비자)
SQS 대기열에서 메시지를 검색하고 처리하는 컴포넌트이다. (예: EC2 인스턴스, Lambda 함수)
### Queue (대기열)
메시지(Message)가 저장되는 버퍼 역할을 하는 저장소이다.
### Message (메시지)
생산자가 보내는 데이터의 내용이며, 최대 크기는 256KB이다.
## 원리
### Decoupling (느슨한 결합)
생산자와 소비자가 직접 통신하지 않고 대기열(Queue)을 통해 간접적으로 통신한다. 생산자는 소비자의 가용성이나 처리 속도에 관계없이 메시지를 보내고 자신의 작업을 계속한다.
### Asynchronous Communication (비동기 통신)
메시지 전송 시 응답을 즉시 기다리지 않고, 나중에 소비자가 메시지를 처리할 때까지 대기열에 메시지를 보관한다. 이로써 시스템 복원력과 확장성을 높인다.
### 메시지 수명 주기
1. Send: 생산자가 SQS에 메시지를 보낸다.
2. Receive: 소비자가 대기열에서 메시지를 수신한다.
3. Visibility Timeout (가시성 제한 시간): 메시지를 수신한 후, 다른 소비자가 이 메시지를 가져가지 못하도록 메시지가 숨겨진 상태로 유지되는 시간이다. 이 시간 내에 처리가 완료되어야 한다.
4. Delete: 소비자가 메시지 처리를 완료하면 SQS에서 메시지를 삭제한다.
### 확장성 및 탄력성
대기열의 크기에 제한이 없으며, 트래픽이 폭주해도 메시지를 안전하게 버퍼링하여 생산자의 과부하를 방지한다. 소비자는 자신의 처리 능력에 따라 유연하게 메시지를 가져가며, 필요에 따라 수평 확장할 수 있다.
## 특징
### Reliability (안정성)
메시지는 소비자가 성공적으로 삭제하기 전까지 대기열에 안전하게 보관된다. 기본적으로 여러 서버에 중복 저장되어 손실을 방지한다.
### Message Ordering (메시지 순서)
- Standard Queue: 최선 노력 순서(Best-effort Ordering)를 제공한다. 메시지가 전송된 순서와 다른 순서로 수신될 수 있다.
- FIFO (First-In, First-Out) Queue: 메시지가 정확히 전송된 순서대로 한 번만 수신 및 처리되도록 보장한다. (고유한 메시지 처리 순서가 필요한 경우 사용)
### Fault Tolerance (내결함성)
소비자 컴포넌트에 장애가 발생해도, 생산자는 계속 메시지를 보낼 수 있다. 메시지는 대기열에 남아있다가 소비자가 복구되면 처리된다.
## 비교
| 구분 | SQS (메시지 대기열) | SNS (알림 서비스) |
| :--- | :--- | :--- |
| 통신 방식 | 1:1 (Queue-to-Consumer) | 1:N (Publisher-to-Subscriber) |
| 목적 | 작업 처리를 위한 버퍼링 및 비동기 분리 | 알림/팬아웃 및 실시간 데이터 분배 |
| 메시지 보관 | 가능 (소비자가 처리할 때까지) | 불가 (즉시 전달 후 삭제) |
## 예시
### 비동기 주문 처리 시스템
1. 웹 애플리케이션(Producer)이 고객의 주문 요청을 수신하면, 주문 데이터를 SQS 대기열에 보낸다.
2. 주문 처리 시스템(Consumer, 예: EC2 또는 Lambda)은 SQS에서 메시지를 가져와 결제 처리, 재고 차감, 이메일 발송 등의 장기 실행 백엔드 작업을 시작한다.
3. 웹 애플리케이션은 즉시 사용자에게 '주문 접수 완료' 메시지를 반환하여, 백엔드 처리 시간과 관계없이 사용자 경험(Latency)을 개선한다.